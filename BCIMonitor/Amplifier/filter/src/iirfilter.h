#ifndef IIRFILTER_H
#define IIRFILTER_H
#include<QString>
#include<QDebug>
class IIRFILTER
{
public:
    static const int N=11;
    int N_IIR=5;
    IIRFILTER();
    void initW();
    //250Hz
    double low_b250[5][3] = {
      {
         0.4314910061647,                 0,                 0
      },
      {
                       1,                 2,                 1
      },
      {
         0.3112377257993,                 0,                 0
      },
      {
                       1,                 2,                 1
      },
      {
                       1,                 0,                 0
      }
    };
    double low_a250[5][3] = {
      {
                       1,                 0,                 0
      },
      {
                       1,   0.2723753556633,   0.4535886689957
      },
      {
                       1,                 0,                 0
      },
      {
                       1,   0.1964664038167,  0.04848449938038
      },
      {
                       1,                 0,                 0
      }
    };
    double high_b250[5][3] = {
      {
         0.9951749097956,                 0,                 0
      },
      {
                       1,                -2,                 1
      },
      {
         0.9884847019825,                 0,                 0
      },
      {
                       1,                -2,                 1
      },
      {
                       1,                 0,                 0
      }
    };
    double high_a250[5][3] = {
      {
                       1,                 0,                 0
      },
      {
                       1,   -1.990271241662,   0.9904283975206
      },
      {
                       1,                 0,                 0
      },
      {
                       1,   -1.976891354287,   0.9770474536429
      },
      {
                       1,                 0,                 0
      }
    };
    //500Hz
    double low_b500[5][3] = {
      {
         0.1400055865274,                 0,                 0
      },
      {
                       1,                 2,                 1
      },
      {
         0.1059010989949,                 0,                 0
      },
      {
                       1,                 2,                 1
      },
      {
                       1,                 0,                 0
      }
    };
    double low_a500[5][3] = {
      {
                       1,                 0,                 0
      },
      {
                       1,  -0.9845430147412,   0.5445653608508
      },
      {
                       1,                 0,                 0
      },
      {
                       1,  -0.7447144778643,    0.168318873844
      },
      {
                       1,                 0,                 0
      }
    };
    double high_b500[5][3] = {
      {
         0.9975914665398,                 0,                 0
      },
      {
                       1,                -2,                 1
      },
      {
         0.9942188212983,                 0,                 0
      },
      {
                       1,                -2,                 1
      },
      {
                       1,                 0,                 0
      }
    };
    double high_a500[5][3] = {
      {
                       1,                 0,                 0
      },
      {
                       1,   -1.995163241284,   0.9952026248755
      },
      {
                       1,                 0,                 0
      },
      {
                       1,   -1.988418017375,   0.9884572678187
      },
      {
                       1,                 0,                 0
      }
    };
    //1000Hz
    double low_b1000[5][3] = {
      {
        0.04091915984537,                 0,                 0
      },
      {
                       1,                 2,                 1
      },
      {
        0.03415210294247,                 0,                 0
      },
      {
                       1,                 2,                 1
      },
      {
                       1,                 0,                 0
      }
    };
    double low_a1000[5][3] = {
      {
                       1,                 0,                 0
      },
      {
                       1,   -1.556104491943,   0.7197811313244
      },
      {
                       1,                 0,                 0
      },
      {
                       1,   -1.298761778074,    0.435370189844
      },
      {
                       1,                 0,                 0
      }
    };
//    double high_b1000[5][3] = {
//      {
//         0.9987967457114,                 0,                 0
//      },
//      {
//                       1,                -2,                 1
//      },
//      {
//         0.9971034911904,                 0,                 0
//      },
//      {
//                       1,                -2,                 1
//      },
//      {
//                       1,                 0,                 0
//      }
//    };
//    double high_a1000[5][3] = {
//      {
//                       1,                 0,                 0
//      },
//      {
//                       1,    -1.99758856255,   0.9975984202952
//      },
//      {
//                       1,                 0,                 0
//      },
//      {
//                       1,   -1.994202061864,   0.9942119028975
//      },
//      {
//                       1,                 0,                 0
//      }
//    };
    double high_b1000[5][3] = {
      {
         0.1129140887404,                 0,                 0
      },
      {
                       1,                 0,                -1
      },
      {
         0.1129140887404,                 0,                 0
      },
      {
                       1,                 0,                -1
      },
      {
                       1,                 0,                 0
      }
    };
    double high_a1000[5][3] = {
      {
                       1,                 0,                 0
      },
      {
                       1,   -1.991135445886,   0.9911766958706
      },
      {
                       1,                 0,                 0
      },
      {
                       1,   -1.662114752857,   0.7134444331663
      },
      {
                       1,                 0,                 0
      }
    };


    double matrixh[32][5][3];
    double matrixl[32][5][3];



    double iir(double *a, double *b, double *w, double xin, int N_IIR);
    double B_filter(int channel_num,int i,double xn);
    int n_N=20;
    double x[32][21];
    double y[32][21];

};

#endif // IIRFILTER_H
